global
    daemon
    maxconn 4096
    log stdout local0

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option httplog
    option dontlognull
    option redispatch
    retries 3
    maxconn 2000
    log global

# Frontend for HTTP traffic
frontend neuroquantum_frontend
    bind *:80
    bind *:443
    mode http

    # Health check endpoint
    acl is_health_check path_beg /health

    # Route to NeuroQuantumDB backend
    default_backend neuroquantum_backend

# Backend for NeuroQuantumDB instances
backend neuroquantum_backend
    mode http
    balance roundrobin
    option httpchk GET /health

    # NeuroQuantumDB main instance
    server neuroquantum1 neuroquantumdb:8080 check inter 5s fall 3 rise 2

# HAProxy statistics frontend
frontend stats_frontend
    bind *:8404
    mode http
    stats enable
    stats uri /
    stats refresh 10s
