<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API for state machine and snapshot."><title>RaftStateMachine in openraft::storage - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="openraft" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">RaftStateMachine</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../openraft/index.html">openraft</a><span class="version">0.9.21</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Raft<wbr>State<wbr>Machine</a></h2><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.SnapshotBuilder" title="SnapshotBuilder">SnapshotBuilder</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.applied_state" title="applied_state">applied_state</a></li><li><a href="#tymethod.apply" title="apply">apply</a></li><li><a href="#tymethod.begin_receiving_snapshot" title="begin_receiving_snapshot">begin_receiving_snapshot</a></li><li><a href="#tymethod.get_current_snapshot" title="get_current_snapshot">get_current_snapshot</a></li><li><a href="#tymethod.get_snapshot_builder" title="get_snapshot_builder">get_snapshot_builder</a></li><li><a href="#tymethod.install_snapshot" title="install_snapshot">install_snapshot</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In openraft::<wbr>storage</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">openraft</a>::<wbr><a href="index.html">storage</a></div><h1>Trait <span class="trait">Raft<wbr>State<wbr>Machine</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/openraft/storage/v2.rs.html#153-257">Source</a> </span></div><pre class="rust item-decl"><code>pub trait RaftStateMachine&lt;C&gt;:
    Sealed
    + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>
    + <a class="trait" href="../trait.OptionalSync.html" title="trait openraft::OptionalSync">OptionalSync</a>
    + 'static
    + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a><div class="where">where
    C: <a class="trait" href="../type_config/trait.RaftTypeConfig.html" title="trait openraft::type_config::RaftTypeConfig">RaftTypeConfig</a>,</div>{
    type <a href="#associatedtype.SnapshotBuilder" class="associatedtype">SnapshotBuilder</a>: <a class="trait" href="trait.RaftSnapshotBuilder.html" title="trait openraft::storage::RaftSnapshotBuilder">RaftSnapshotBuilder</a>&lt;C&gt;;

    // Required methods
    fn <a href="#tymethod.applied_state" class="fn">applied_state</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="struct" href="../struct.StoredMembership.html" title="struct openraft::StoredMembership">StoredMembership</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>, C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Node" title="type openraft::type_config::RaftTypeConfig::Node">Node</a>&gt;), <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.apply" class="fn">apply</a>&lt;I&gt;(
        &amp;mut self,
        entries: I,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.R" title="type openraft::type_config::RaftTypeConfig::R">R</a>&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>
       <span class="where">where I: <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Entry" title="type openraft::type_config::RaftTypeConfig::Entry">Entry</a>&gt; + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,
             I::<a class="associatedtype" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html#associatedtype.IntoIter" title="type core::iter::traits::collect::IntoIterator::IntoIter">IntoIter</a>: <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a></span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.get_snapshot_builder" class="fn">get_snapshot_builder</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = Self::<a class="associatedtype" href="trait.RaftStateMachine.html#associatedtype.SnapshotBuilder" title="type openraft::storage::RaftStateMachine::SnapshotBuilder">SnapshotBuilder</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.begin_receiving_snapshot" class="fn">begin_receiving_snapshot</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.SnapshotData" title="type openraft::type_config::RaftTypeConfig::SnapshotData">SnapshotData</a>&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.install_snapshot" class="fn">install_snapshot</a>(
        &amp;mut self,
        meta: &amp;<a class="struct" href="struct.SnapshotMeta.html" title="struct openraft::storage::SnapshotMeta">SnapshotMeta</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>, C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Node" title="type openraft::type_config::RaftTypeConfig::Node">Node</a>&gt;,
        snapshot: <a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.SnapshotData" title="type openraft::type_config::RaftTypeConfig::SnapshotData">SnapshotData</a>&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.get_current_snapshot" class="fn">get_current_snapshot</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="struct.Snapshot.html" title="struct openraft::storage::Snapshot">Snapshot</a>&lt;C&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>API for state machine and snapshot.</p>
<p>Snapshot is part of the state machine, because usually a snapshot is the persisted state of the
state machine.</p>
<p>See: <a href="../docs/components/state_machine/index.html" title="mod openraft::docs::components::state_machine"><code>StateMachine</code></a></p>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><details class="toggle" open><summary><section id="associatedtype.SnapshotBuilder" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#157">Source</a><h4 class="code-header">type <a href="#associatedtype.SnapshotBuilder" class="associatedtype">SnapshotBuilder</a>: <a class="trait" href="trait.RaftSnapshotBuilder.html" title="trait openraft::storage::RaftSnapshotBuilder">RaftSnapshotBuilder</a>&lt;C&gt;</h4></section></summary><div class="docblock"><p>Snapshot builder type.</p>
</div></details></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.applied_state" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#171-173">Source</a><h4 class="code-header">fn <a href="#tymethod.applied_state" class="fn">applied_state</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="struct" href="../struct.StoredMembership.html" title="struct openraft::StoredMembership">StoredMembership</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>, C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Node" title="type openraft::type_config::RaftTypeConfig::Node">Node</a>&gt;), <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Returns the last applied log id which is recorded in state machine, and the last applied
membership config.</p>
<h6 id="correctness-requirements"><a class="doc-anchor" href="#correctness-requirements">§</a>Correctness requirements</h6>
<p>It is all right to return a membership with greater log id than the
last-applied-log-id.
Because upon startup, the last membership will be loaded by scanning logs from the
<code>last-applied-log-id</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.apply" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#201-204">Source</a><h4 class="code-header">fn <a href="#tymethod.apply" class="fn">apply</a>&lt;I&gt;(
    &amp;mut self,
    entries: I,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.R" title="type openraft::type_config::RaftTypeConfig::R">R</a>&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a><div class="where">where
    I: <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Entry" title="type openraft::type_config::RaftTypeConfig::Entry">Entry</a>&gt; + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,
    I::<a class="associatedtype" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html#associatedtype.IntoIter" title="type core::iter::traits::collect::IntoIterator::IntoIter">IntoIter</a>: <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,</div></h4></section></summary><div class="docblock"><p>Apply the given payload of entries to the state machine.</p>
<p>The Raft protocol guarantees that only logs which have been <em>committed</em>, that is, logs which
have been replicated to a quorum of the cluster, will be applied to the state machine.</p>
<p>This is where the business logic of interacting with your application’s state machine
should live. This is 100% application specific. Perhaps this is where an application
specific transaction is being started, or perhaps committed. This may be where a key/value
is being stored.</p>
<p>For every entry to apply, an implementation should:</p>
<ul>
<li>Store the log id as last applied log id.</li>
<li>Deal with the business logic log.</li>
<li>Store membership config if <code>RaftEntry::get_membership()</code> returns <code>Some</code>.</li>
</ul>
<p>Note that for a membership log, the implementation need to do nothing about it, except
storing it.</p>
<p>An implementation may choose to persist either the state machine or the snapshot:</p>
<ul>
<li>
<p>An implementation with persistent state machine: persists the state on disk before
returning from <code>apply()</code>. So that a snapshot does not need to be persistent.</p>
</li>
<li>
<p>An implementation with persistent snapshot: <code>apply()</code> does not have to persist state on
disk. But every snapshot has to be persistent. And when starting up the application, the
state machine should be rebuilt from the last snapshot.</p>
</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.get_snapshot_builder" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#215">Source</a><h4 class="code-header">fn <a href="#tymethod.get_snapshot_builder" class="fn">get_snapshot_builder</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = Self::<a class="associatedtype" href="trait.RaftStateMachine.html#associatedtype.SnapshotBuilder" title="type openraft::storage::RaftStateMachine::SnapshotBuilder">SnapshotBuilder</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Get the snapshot builder for the state machine.</p>
<p>Usually it returns a snapshot view of the state machine(i.e., subsequent changes to the
state machine won’t affect the return snapshot view), or just a copy of the entire state
machine.</p>
<p>The method is intentionally async to give the implementation a chance to use
asynchronous sync primitives to serialize access to the common internal object, if
needed.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.begin_receiving_snapshot" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#224">Source</a><h4 class="code-header">fn <a href="#tymethod.begin_receiving_snapshot" class="fn">begin_receiving_snapshot</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.SnapshotData" title="type openraft::type_config::RaftTypeConfig::SnapshotData">SnapshotData</a>&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Create a new blank snapshot, returning a writable handle to the snapshot object.</p>
<p>Openraft will use this handle to receive snapshot data.</p>
<p>See the <a href="../docs/getting_started/index.html#3-implement-raftlogstorage-and-raftstatemachine" title="mod openraft::docs::getting_started">storage chapter of the guide</a> for details on log compaction / snapshotting.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.install_snapshot" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#237-241">Source</a><h4 class="code-header">fn <a href="#tymethod.install_snapshot" class="fn">install_snapshot</a>(
    &amp;mut self,
    meta: &amp;<a class="struct" href="struct.SnapshotMeta.html" title="struct openraft::storage::SnapshotMeta">SnapshotMeta</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>, C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Node" title="type openraft::type_config::RaftTypeConfig::Node">Node</a>&gt;,
    snapshot: <a class="struct" href="https://doc.rust-lang.org/1.91.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.SnapshotData" title="type openraft::type_config::RaftTypeConfig::SnapshotData">SnapshotData</a>&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Install a snapshot which has finished streaming from the leader.</p>
<p>Before this method returns:</p>
<ul>
<li>The state machine should be replaced with the new contents of the snapshot,</li>
<li>the input snapshot should be saved, i.e., <a href="trait.RaftStateMachine.html#tymethod.get_current_snapshot"><code>Self::get_current_snapshot</code></a> should return it.</li>
<li>and all other snapshots should be deleted at this point.</li>
</ul>
<h6 id="snapshot"><a class="doc-anchor" href="#snapshot">§</a>snapshot</h6>
<p>A snapshot created from an earlier call to <code>begin_receiving_snapshot</code> which provided the
snapshot.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.get_current_snapshot" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#256">Source</a><h4 class="code-header">fn <a href="#tymethod.get_current_snapshot" class="fn">get_current_snapshot</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="struct.Snapshot.html" title="struct openraft::storage::Snapshot">Snapshot</a>&lt;C&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Get a readable handle to the current snapshot.</p>
<h6 id="implementation-algorithm"><a class="doc-anchor" href="#implementation-algorithm">§</a>implementation algorithm</h6>
<p>Implementing this method should be straightforward. Check the configured snapshot
directory for any snapshot files. A proper implementation will only ever have one
active snapshot, though another may exist while it is being created. As such, it is
recommended to use a file naming pattern which will allow for easily distinguishing between
the current live snapshot, and any new snapshot which is being created.</p>
<p>A proper snapshot implementation will store last-applied-log-id and the
last-applied-membership config as part of the snapshot, which should be decoded for
creating this method’s response data.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/1.91.1/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><details class="toggle implementors-toggle"><summary><section id="impl-RaftStateMachine%3CC%3E-for-Adaptor%3CC,+S%3E" class="impl"><a class="src rightside" href="../../src/openraft/storage/adapter.rs.html#169-207">Source</a><a href="#impl-RaftStateMachine%3CC%3E-for-Adaptor%3CC,+S%3E" class="anchor">§</a><h3 class="code-header">impl&lt;C, S&gt; <a class="trait" href="trait.RaftStateMachine.html" title="trait openraft::storage::RaftStateMachine">RaftStateMachine</a>&lt;C&gt; for <a class="struct" href="struct.Adaptor.html" title="struct openraft::storage::Adaptor">Adaptor</a>&lt;C, S&gt;<div class="where">where
    C: <a class="trait" href="../type_config/trait.RaftTypeConfig.html" title="trait openraft::type_config::RaftTypeConfig">RaftTypeConfig</a>,
    S: <a class="trait" href="trait.RaftStorage.html" title="trait openraft::storage::RaftStorage">RaftStorage</a>&lt;C&gt;,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.SnapshotBuilder-1" class="associatedtype trait-impl"><a class="src rightside" href="../../src/openraft/storage/adapter.rs.html#174">Source</a><a href="#associatedtype.SnapshotBuilder-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.SnapshotBuilder" class="associatedtype">SnapshotBuilder</a> = &lt;S as <a class="trait" href="trait.RaftStorage.html" title="trait openraft::storage::RaftStorage">RaftStorage</a>&lt;C&gt;&gt;::<a class="associatedtype" href="trait.RaftStorage.html#associatedtype.SnapshotBuilder" title="type openraft::storage::RaftStorage::SnapshotBuilder">SnapshotBuilder</a></h4></section></div></details></div><script src="../../trait.impl/openraft/storage/v2/trait.RaftStateMachine.js" async></script></section></div></main></body></html>