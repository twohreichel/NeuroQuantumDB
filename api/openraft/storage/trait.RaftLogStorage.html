<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API for log store."><title>RaftLogStorage in openraft::storage - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="openraft" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">RaftLogStorage</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../openraft/index.html">openraft</a><span class="version">0.9.21</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Raft<wbr>LogStorage</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#to-ensure-correctness" title="To ensure correctness:">To ensure correctness:</a></li></ul><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.LogReader" title="LogReader">LogReader</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.append" title="append">append</a></li><li><a href="#tymethod.get_log_reader" title="get_log_reader">get_log_reader</a></li><li><a href="#tymethod.get_log_state" title="get_log_state">get_log_state</a></li><li><a href="#tymethod.purge" title="purge">purge</a></li><li><a href="#tymethod.read_vote" title="read_vote">read_vote</a></li><li><a href="#tymethod.save_vote" title="save_vote">save_vote</a></li><li><a href="#tymethod.truncate" title="truncate">truncate</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.read_committed" title="read_committed">read_committed</a></li><li><a href="#method.save_committed" title="save_committed">save_committed</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In openraft::<wbr>storage</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">openraft</a>::<wbr><a href="index.html">storage</a></div><h1>Trait <span class="trait">Raft<wbr>LogStorage</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/openraft/storage/v2.rs.html#50-144">Source</a> </span></div><pre class="rust item-decl"><code>pub trait RaftLogStorage&lt;C&gt;:
    Sealed
    + <a class="trait" href="trait.RaftLogReader.html" title="trait openraft::storage::RaftLogReader">RaftLogReader</a>&lt;C&gt;
    + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>
    + <a class="trait" href="../trait.OptionalSync.html" title="trait openraft::OptionalSync">OptionalSync</a>
    + 'static
    + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a><div class="where">where
    C: <a class="trait" href="../type_config/trait.RaftTypeConfig.html" title="trait openraft::type_config::RaftTypeConfig">RaftTypeConfig</a>,</div>{
    type <a href="#associatedtype.LogReader" class="associatedtype">LogReader</a>: <a class="trait" href="trait.RaftLogReader.html" title="trait openraft::storage::RaftLogReader">RaftLogReader</a>&lt;C&gt;;

    // Required methods
    fn <a href="#tymethod.get_log_state" class="fn">get_log_state</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="struct.LogState.html" title="struct openraft::storage::LogState">LogState</a>&lt;C&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.get_log_reader" class="fn">get_log_reader</a>(&amp;mut self) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = Self::<a class="associatedtype" href="trait.RaftLogStorage.html#associatedtype.LogReader" title="type openraft::storage::RaftLogStorage::LogReader">LogReader</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.save_vote" class="fn">save_vote</a>(
        &amp;mut self,
        vote: &amp;<a class="struct" href="../struct.Vote.html" title="struct openraft::Vote">Vote</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.read_vote" class="fn">read_vote</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../struct.Vote.html" title="struct openraft::Vote">Vote</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.append" class="fn">append</a>&lt;I&gt;(
        &amp;mut self,
        entries: I,
        callback: <a class="struct" href="struct.LogFlushed.html" title="struct openraft::storage::LogFlushed">LogFlushed</a>&lt;C&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>
       <span class="where">where I: <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Entry" title="type openraft::type_config::RaftTypeConfig::Entry">Entry</a>&gt; + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,
             I::<a class="associatedtype" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html#associatedtype.IntoIter" title="type core::iter::traits::collect::IntoIterator::IntoIter">IntoIter</a>: <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a></span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.truncate" class="fn">truncate</a>(
        &amp;mut self,
        log_id: <a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.purge" class="fn">purge</a>(
        &amp;mut self,
        log_id: <a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;

    // Provided methods
    fn <a href="#method.save_committed" class="fn">save_committed</a>(
        &amp;mut self,
        _committed: <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.read_committed" class="fn">read_committed</a>(
        &amp;mut self,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>API for log store.</p>
<p><code>vote</code> API are also included because in raft, vote is part to the log: <code>vote</code> is about <strong>when</strong>,
while <code>log</code> is about <strong>what</strong>. A distributed consensus is about <strong>at what a time, happened what
a event</strong>.</p>
<h4 id="to-ensure-correctness"><a class="doc-anchor" href="#to-ensure-correctness">§</a>To ensure correctness:</h4>
<ul>
<li>Logs must be consecutive, i.e., there must <strong>NOT</strong> leave a <strong>hole</strong> in logs.</li>
<li>All write-IO must be serialized, i.e., the internal implementation must <strong>NOT</strong> apply a latter
write request before a former write request is completed. This rule applies to both <code>vote</code> and
<code>log</code> IO. E.g., Saving a vote and appending a log entry must be serialized too.</li>
</ul>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><details class="toggle" open><summary><section id="associatedtype.LogReader" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#57">Source</a><h4 class="code-header">type <a href="#associatedtype.LogReader" class="associatedtype">LogReader</a>: <a class="trait" href="trait.RaftLogReader.html" title="trait openraft::storage::RaftLogReader">RaftLogReader</a>&lt;C&gt;</h4></section></summary><div class="docblock"><p>Log reader type.</p>
<p>Log reader is used by multiple replication tasks, which read logs and send them to remote
nodes.</p>
</div></details></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.get_log_state" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#66">Source</a><h4 class="code-header">fn <a href="#tymethod.get_log_state" class="fn">get_log_state</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="struct.LogState.html" title="struct openraft::storage::LogState">LogState</a>&lt;C&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Returns the last deleted log id and the last log id.</p>
<p>The impl should <strong>not</strong> consider the applied log id in state machine.
The returned <code>last_log_id</code> could be the log id of the last present log entry, or the
<code>last_purged_log_id</code> if there is no entry at all.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.get_log_reader" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#72">Source</a><h4 class="code-header">fn <a href="#tymethod.get_log_reader" class="fn">get_log_reader</a>(&amp;mut self) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = Self::<a class="associatedtype" href="trait.RaftLogStorage.html#associatedtype.LogReader" title="type openraft::storage::RaftLogStorage::LogReader">LogReader</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Get the log reader.</p>
<p>The method is intentionally async to give the implementation a chance to use asynchronous
primitives to serialize access to the common internal object, if needed.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.save_vote" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#79">Source</a><h4 class="code-header">fn <a href="#tymethod.save_vote" class="fn">save_vote</a>(
    &amp;mut self,
    vote: &amp;<a class="struct" href="../struct.Vote.html" title="struct openraft::Vote">Vote</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Save vote to storage.</p>
<h6 id="to-ensure-correctness-1"><a class="doc-anchor" href="#to-ensure-correctness-1">§</a>To ensure correctness:</h6>
<p>The vote must be persisted on disk before returning.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.read_vote" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#82">Source</a><h4 class="code-header">fn <a href="#tymethod.read_vote" class="fn">read_vote</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../struct.Vote.html" title="struct openraft::Vote">Vote</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Return the last saved vote by <a href="trait.RaftLogStorage.html#tymethod.save_vote"><code>Self::save_vote</code></a>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.append" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#126-129">Source</a><h4 class="code-header">fn <a href="#tymethod.append" class="fn">append</a>&lt;I&gt;(
    &amp;mut self,
    entries: I,
    callback: <a class="struct" href="struct.LogFlushed.html" title="struct openraft::storage::LogFlushed">LogFlushed</a>&lt;C&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a><div class="where">where
    I: <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.Entry" title="type openraft::type_config::RaftTypeConfig::Entry">Entry</a>&gt; + <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,
    I::<a class="associatedtype" href="https://doc.rust-lang.org/1.91.1/core/iter/traits/collect/trait.IntoIterator.html#associatedtype.IntoIter" title="type core::iter::traits::collect::IntoIterator::IntoIter">IntoIter</a>: <a class="trait" href="../trait.OptionalSend.html" title="trait openraft::OptionalSend">OptionalSend</a>,</div></h4></section></summary><div class="docblock"><p>Append log entries and call the <code>callback</code> once logs are persisted on disk.</p>
<p>It should returns immediately after saving the input log entries in memory, and calls the
<code>callback</code> when the entries are persisted on disk, i.e., avoid blocking.</p>
<p>This method is still async because preparing the IO is usually async.</p>
<h6 id="to-ensure-correctness-2"><a class="doc-anchor" href="#to-ensure-correctness-2">§</a>To ensure correctness:</h6>
<ul>
<li>
<p>When this method returns, the entries must be readable, i.e., a <code>LogReader</code> can read these
entries.</p>
</li>
<li>
<p>When the <code>callback</code> is called, the entries must be persisted on disk.</p>
<p>NOTE that: the <code>callback</code> can be called either before or after this method returns.</p>
</li>
<li>
<p>There must not be a <strong>hole</strong> in logs. Because Raft only examine the last log id to ensure
correctness.</p>
</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.truncate" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#136">Source</a><h4 class="code-header">fn <a href="#tymethod.truncate" class="fn">truncate</a>(
    &amp;mut self,
    log_id: <a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Truncate logs since <code>log_id</code>, inclusive</p>
<h6 id="to-ensure-correctness-3"><a class="doc-anchor" href="#to-ensure-correctness-3">§</a>To ensure correctness:</h6>
<ul>
<li>It must not leave a <strong>hole</strong> in logs.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.purge" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#143">Source</a><h4 class="code-header">fn <a href="#tymethod.purge" class="fn">purge</a>(
    &amp;mut self,
    log_id: <a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Purge logs upto <code>log_id</code>, inclusive</p>
<h6 id="to-ensure-correctness-4"><a class="doc-anchor" href="#to-ensure-correctness-4">§</a>To ensure correctness:</h6>
<ul>
<li>It must not leave a <strong>hole</strong> in logs.</li>
</ul>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.save_committed" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#49">Source</a><h4 class="code-header">fn <a href="#method.save_committed" class="fn">save_committed</a>(
    &amp;mut self,
    _committed: <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.91.1/std/primitive.unit.html">()</a>, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Saves the last committed log id to storage.</p>
<h5 id="optional-feature"><a class="doc-anchor" href="#optional-feature">§</a>Optional feature</h5>
<p>If the state machine flushes state to disk before
returning from <code>apply()</code>, then the application does not need to implement this method.
Otherwise, this method is also optional(but not recommended), but your application has to
deal with state reversion of state machine carefully upon restart. E.g., do not serve
read operation a new <code>commit</code> message is received.</p>
<p>See: <a href="../docs/data/log_pointers/index.html#optionally-persisted-committed" title="mod openraft::docs::data::log_pointers"><code>docs::data::log_pointers</code></a>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.read_committed" class="method"><a class="src rightside" href="../../src/openraft/storage/v2.rs.html#49">Source</a><h4 class="code-header">fn <a href="#method.read_committed" class="fn">read_committed</a>(
    &amp;mut self,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../log_id/struct.LogId.html" title="struct openraft::log_id::LogId">LogId</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;, <a class="enum" href="../enum.StorageError.html" title="enum openraft::StorageError">StorageError</a>&lt;C::<a class="associatedtype" href="../type_config/trait.RaftTypeConfig.html#associatedtype.NodeId" title="type openraft::type_config::RaftTypeConfig::NodeId">NodeId</a>&gt;&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.91.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Return the last saved committed log id by <a href="trait.RaftLogStorage.html#method.save_committed"><code>Self::save_committed</code></a>.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/1.91.1/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><details class="toggle implementors-toggle"><summary><section id="impl-RaftLogStorage%3CC%3E-for-Adaptor%3CC,+S%3E" class="impl"><a class="src rightside" href="../../src/openraft/storage/adapter.rs.html#119-167">Source</a><a href="#impl-RaftLogStorage%3CC%3E-for-Adaptor%3CC,+S%3E" class="anchor">§</a><h3 class="code-header">impl&lt;C, S&gt; <a class="trait" href="trait.RaftLogStorage.html" title="trait openraft::storage::RaftLogStorage">RaftLogStorage</a>&lt;C&gt; for <a class="struct" href="struct.Adaptor.html" title="struct openraft::storage::Adaptor">Adaptor</a>&lt;C, S&gt;<div class="where">where
    C: <a class="trait" href="../type_config/trait.RaftTypeConfig.html" title="trait openraft::type_config::RaftTypeConfig">RaftTypeConfig</a>,
    S: <a class="trait" href="trait.RaftStorage.html" title="trait openraft::storage::RaftStorage">RaftStorage</a>&lt;C&gt;,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.LogReader-1" class="associatedtype trait-impl"><a class="src rightside" href="../../src/openraft/storage/adapter.rs.html#124">Source</a><a href="#associatedtype.LogReader-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.LogReader" class="associatedtype">LogReader</a> = &lt;S as <a class="trait" href="trait.RaftStorage.html" title="trait openraft::storage::RaftStorage">RaftStorage</a>&lt;C&gt;&gt;::<a class="associatedtype" href="trait.RaftStorage.html#associatedtype.LogReader" title="type openraft::storage::RaftStorage::LogReader">LogReader</a></h4></section></div></details></div><script src="../../trait.impl/openraft/storage/v2/trait.RaftLogStorage.js" async></script></section></div></main></body></html>