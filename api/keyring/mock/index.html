<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Mock credential store"><title>keyring::mock - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="keyring" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module mock</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../keyring/index.html">keyring</a><span class="version">3.6.3</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module mock</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#mock-credential-store" title="Mock credential store">Mock credential store</a></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate keyring</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">keyring</a></div><h1>Module <span>mock</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/keyring/mock.rs.html#1-336">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="mock-credential-store"><a class="doc-anchor" href="#mock-credential-store">§</a>Mock credential store</h2>
<p>To facilitate testing of clients, this crate provides a Mock credential store
that is platform-independent, provides no persistence, and allows the client
to specify the return values (including errors) for each call. The credentials
in this store have no attributes at all.</p>
<p>To use this credential store instead of the default, make this call during
application startup <em>before</em> creating any entries:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>set_default_credential_builder(mock::default_credential_builder());</code></pre></div>
<p>You can then create entries as you usually do, and call their usual methods
to set, get, and delete passwords.  There is no persistence other than
in the entry itself, so getting a password before setting it will always result
in a <a href="../error/enum.Error.html#variant.NoEntry" title="variant keyring::error::Error::NoEntry">NoEntry</a> error.</p>
<p>If you want a method call on an entry to fail in a specific way, you can
downcast the entry to a <a href="struct.MockCredential.html" title="struct keyring::mock::MockCredential">MockCredential</a> and then call <a href="struct.MockCredential.html#method.set_error" title="method keyring::mock::MockCredential::set_error">set_error</a>
with the appropriate error.  The next entry method called on the credential
will fail with the error you set.  The error will then be cleared, so the next
call on the mock will operate as usual.  Here’s a complete example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>entry = Entry::new(<span class="string">"service"</span>, <span class="string">"user"</span>).unwrap();
<span class="kw">let </span>mock: <span class="kw-2">&amp;</span>MockCredential = entry.get_credential().downcast_ref().unwrap();
mock.set_error(Error::Invalid(<span class="string">"mock error"</span>.to_string(), <span class="string">"takes precedence"</span>.to_string()));
entry.set_password(<span class="string">"test"</span>).expect_err(<span class="string">"error will override"</span>);
entry.set_password(<span class="string">"test"</span>).expect(<span class="string">"error has been cleared"</span>);</code></pre></div></div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.MockCredential.html" title="struct keyring::mock::MockCredential">Mock<wbr>Credential</a></dt><dd>The concrete mock credential</dd><dt><a class="struct" href="struct.MockCredentialBuilder.html" title="struct keyring::mock::MockCredentialBuilder">Mock<wbr>Credential<wbr>Builder</a></dt><dd>The builder for mock credentials.</dd><dt><a class="struct" href="struct.MockData.html" title="struct keyring::mock::MockData">Mock<wbr>Data</a></dt><dd>The (in-memory) persisted data for a mock credential.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.default_credential_builder.html" title="fn keyring::mock::default_credential_builder">default_<wbr>credential_<wbr>builder</a></dt><dd>Return a mock credential builder for use by clients.</dd></dl></section></div></main></body></html>